// Code generated by Fern. DO NOT EDIT.

package link

import (
	context "context"
	vitalgo "github.com/tryVital/vital-go"
	core "github.com/tryVital/vital-go/core"
	internal "github.com/tryVital/vital-go/internal"
	option "github.com/tryVital/vital-go/option"
)

type Client struct {
	WithRawResponse *RawClient

	options *core.RequestOptions
	baseURL string
	caller  *internal.Caller
}

func NewClient(options *core.RequestOptions) *Client {
	return &Client{
		WithRawResponse: NewRawClient(options),
		options:         options,
		baseURL:         options.BaseURL,
		caller: internal.NewCaller(
			&internal.CallerParams{
				Client:      options.HTTPClient,
				MaxAttempts: options.MaxAttempts,
			},
		),
	}
}

func (c *Client) ListBulkOps(
	ctx context.Context,
	request *vitalgo.ListBulkOpsLinkRequest,
	opts ...option.RequestOption,
) (*vitalgo.BulkOpsResponse, error) {
	response, err := c.WithRawResponse.ListBulkOps(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}

func (c *Client) BulkImport(
	ctx context.Context,
	request *vitalgo.BulkImportConnectionsBody,
	opts ...option.RequestOption,
) (*vitalgo.BulkImportConnectionsResponse, error) {
	response, err := c.WithRawResponse.BulkImport(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}

func (c *Client) BulkTriggerHistoricalPull(
	ctx context.Context,
	request *vitalgo.BulkTriggerHistoricalPullBody,
	opts ...option.RequestOption,
) (any, error) {
	response, err := c.WithRawResponse.BulkTriggerHistoricalPull(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}

func (c *Client) BulkExport(
	ctx context.Context,
	request *vitalgo.BulkExportConnectionsBody,
	opts ...option.RequestOption,
) (*vitalgo.BulkExportConnectionsResponse, error) {
	response, err := c.WithRawResponse.BulkExport(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}

func (c *Client) BulkPause(
	ctx context.Context,
	request *vitalgo.BulkPauseConnectionsBody,
	opts ...option.RequestOption,
) (any, error) {
	response, err := c.WithRawResponse.BulkPause(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}

// Endpoint to generate a user link token, to be used throughout the vital
// link process. The vital link token is a one time use token, that
// expires after 10 minutes. If you would like vital-link widget to launch
// with a specific provider, pass in a provider in the body. If you would
// like to redirect to a custom url after successful or error connection,
// pass in your own custom redirect_url parameter.
func (c *Client) Token(
	ctx context.Context,
	request *vitalgo.LinkTokenExchange,
	opts ...option.RequestOption,
) (*vitalgo.LinkTokenExchangeResponse, error) {
	response, err := c.WithRawResponse.Token(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}

func (c *Client) IsTokenValid(
	ctx context.Context,
	request *vitalgo.LinkTokenValidationRequest,
	opts ...option.RequestOption,
) (map[string]any, error) {
	response, err := c.WithRawResponse.IsTokenValid(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}

// Generate a token to invite a user of Vital mobile app to your team
func (c *Client) CodeCreate(
	ctx context.Context,
	request *vitalgo.CodeCreateLinkRequest,
	opts ...option.RequestOption,
) (*vitalgo.VitalTokenCreatedResponse, error) {
	response, err := c.WithRawResponse.CodeCreate(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}

// REQUEST_SOURCE: VITAL-LINK
// Start link token process
func (c *Client) StartConnect(
	ctx context.Context,
	request *vitalgo.BeginLinkTokenRequest,
	opts ...option.RequestOption,
) (map[string]any, error) {
	response, err := c.WithRawResponse.StartConnect(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}

// REQUEST_SOURCE: VITAL-LINK
// Check link token state - can be hit continuously used as heartbeat
func (c *Client) TokenState(
	ctx context.Context,
	request *vitalgo.TokenStateLinkRequest,
	opts ...option.RequestOption,
) (map[string]any, error) {
	response, err := c.WithRawResponse.TokenState(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}

// Deprecated. Use `POST /v2/link/provider/email/{provider}` instead.
func (c *Client) EmailAuth(
	ctx context.Context,
	request *vitalgo.EmailAuthLink,
	opts ...option.RequestOption,
) (any, error) {
	response, err := c.WithRawResponse.EmailAuth(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}

// Deprecated. Use `POST /v2/link/provider/password/{provider}` instead.
func (c *Client) PasswordAuth(
	ctx context.Context,
	request *vitalgo.PasswordAuthLink,
	opts ...option.RequestOption,
) (any, error) {
	response, err := c.WithRawResponse.PasswordAuth(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}

// This endpoint generates an OAuth link for oauth provider
func (c *Client) GenerateOauthLink(
	ctx context.Context,
	request *vitalgo.GenerateOauthLinkLinkRequest,
	opts ...option.RequestOption,
) (*vitalgo.Source, error) {
	response, err := c.WithRawResponse.GenerateOauthLink(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}

// This connects auth providers that are password based.
func (c *Client) ConnectPasswordProvider(
	ctx context.Context,
	request *vitalgo.IndividualProviderData,
	opts ...option.RequestOption,
) (*vitalgo.ProviderLinkResponse, error) {
	response, err := c.WithRawResponse.ConnectPasswordProvider(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}

// This connects auth providers that are password based.
func (c *Client) CompletePasswordProviderMfa(
	ctx context.Context,
	request *vitalgo.CompletePasswordProviderMfaBody,
	opts ...option.RequestOption,
) (*vitalgo.ProviderLinkResponse, error) {
	response, err := c.WithRawResponse.CompletePasswordProviderMfa(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}

// This connects auth providers that are email based.
func (c *Client) ConnectEmailAuthProvider(
	ctx context.Context,
	request *vitalgo.EmailProviderAuthLink,
	opts ...option.RequestOption,
) (any, error) {
	response, err := c.WithRawResponse.ConnectEmailAuthProvider(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}

// GET List of all available providers given the generated link token.
func (c *Client) GetAllProviders(
	ctx context.Context,
	request *vitalgo.GetAllProvidersLinkRequest,
	opts ...option.RequestOption,
) ([]*vitalgo.SourceLink, error) {
	response, err := c.WithRawResponse.GetAllProviders(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}

func (c *Client) ConnectManualProvider(
	ctx context.Context,
	request *vitalgo.ManualConnectionData,
	opts ...option.RequestOption,
) (map[string]bool, error) {
	response, err := c.WithRawResponse.ConnectManualProvider(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}

// POST Connect the given Vital user to a demo provider.
func (c *Client) ConnectDemoProvider(
	ctx context.Context,
	request *vitalgo.DemoConnectionCreationPayload,
	opts ...option.RequestOption,
) (*vitalgo.DemoConnectionStatus, error) {
	response, err := c.WithRawResponse.ConnectDemoProvider(
		ctx,
		request,
		opts...,
	)
	if err != nil {
		return nil, err
	}
	return response.Body, nil
}
