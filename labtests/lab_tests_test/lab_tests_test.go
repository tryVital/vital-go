// Code generated by Fern. DO NOT EDIT.

package lab_tests_test

import (
	bytes "bytes"
	context "context"
	json "encoding/json"
	require "github.com/stretchr/testify/require"
	vitalgo "github.com/tryVital/vital-go"
	client "github.com/tryVital/vital-go/client"
	option "github.com/tryVital/vital-go/option"
	http "net/http"
	testing "testing"
)

func ResetWireMockRequests(
	t *testing.T,
) {
	WiremockAdminURL := "http://localhost:8080/__admin"
	_, err := http.Post(WiremockAdminURL+"/requests/reset", "application/json", nil)
	require.NoError(t, err)
}

func VerifyRequestCount(
	t *testing.T,
	method string,
	urlPath string,
	queryParams map[string]string,
	expected int,
) {
	WiremockAdminURL := "http://localhost:8080/__admin"
	var reqBody bytes.Buffer
	reqBody.WriteString(`{"method":"`)
	reqBody.WriteString(method)
	reqBody.WriteString(`","urlPath":"`)
	reqBody.WriteString(urlPath)
	reqBody.WriteString(`"}`)
	if len(queryParams) > 0 {
		reqBody.WriteString(`,"queryParameters":{`)
		first := true
		for key, value := range queryParams {
			if !first {
				reqBody.WriteString(",")
			}
			reqBody.WriteString(`"`)
			reqBody.WriteString(key)
			reqBody.WriteString(`":{"equalTo":"`)
			reqBody.WriteString(value)
			reqBody.WriteString(`"}`)
			first = false
		}
		reqBody.WriteString("}")
	}
	resp, err := http.Post(WiremockAdminURL+"/requests/find", "application/json", &reqBody)
	require.NoError(t, err)
	var result struct {
		Requests []interface{} `json:"requests"`
	}
	json.NewDecoder(resp.Body).Decode(&result)
	require.Equal(t, expected, len(result.Requests))
}

func TestLabTestsGetWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.GetLabTestsRequest{}
	_, invocationErr := client.LabTests.Get(
		context.TODO(),
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/lab_tests", nil, 1)
}

func TestLabTestsCreateWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.CreateLabTestRequest{
		Name:        "name",
		Method:      vitalgo.LabTestCollectionMethodTestkit,
		Description: "description",
	}
	_, invocationErr := client.LabTests.Create(
		context.TODO(),
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "POST", "/v3/lab_tests", nil, 1)
}

func TestLabTestsGetByIdWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.GetByIdLabTestsRequest{}
	_, invocationErr := client.LabTests.GetById(
		context.TODO(),
		"lab_test_id",
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/lab_tests/lab_test_id", nil, 1)
}

func TestLabTestsUpdateLabTestWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.UpdateLabTestRequest{}
	_, invocationErr := client.LabTests.UpdateLabTest(
		context.TODO(),
		"lab_test_id",
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "PATCH", "/v3/lab_tests/lab_test_id", nil, 1)
}

func TestLabTestsGetMarkersWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.GetMarkersLabTestsRequest{}
	_, invocationErr := client.LabTests.GetMarkers(
		context.TODO(),
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/lab_tests/markers", nil, 1)
}

func TestLabTestsGetMarkersForOrderSetWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.GetMarkersForOrderSetLabTestsRequest{
		Body: &vitalgo.OrderSetRequest{},
	}
	_, invocationErr := client.LabTests.GetMarkersForOrderSet(
		context.TODO(),
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "POST", "/v3/lab_tests/list_order_set_markers", nil, 1)
}

func TestLabTestsGetMarkersForLabTestWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.GetMarkersForLabTestLabTestsRequest{}
	_, invocationErr := client.LabTests.GetMarkersForLabTest(
		context.TODO(),
		"lab_test_id",
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/lab_tests/lab_test_id/markers", nil, 1)
}

func TestLabTestsGetMarkersByLabAndProviderIdWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.GetMarkersByLabAndProviderIdLabTestsRequest{}
	_, invocationErr := client.LabTests.GetMarkersByLabAndProviderId(
		context.TODO(),
		1,
		"provider_id",
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/lab_tests/1/markers/provider_id", nil, 1)
}

func TestLabTestsGetLabsWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	_, invocationErr := client.LabTests.GetLabs(
		context.TODO(),
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/lab_tests/labs", nil, 1)
}

func TestLabTestsGetPaginatedWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.GetPaginatedLabTestsRequest{}
	_, invocationErr := client.LabTests.GetPaginated(
		context.TODO(),
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/lab_test", nil, 1)
}

func TestLabTestsGetLabTestCollectionInstructionPdfWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	_, invocationErr := client.LabTests.GetLabTestCollectionInstructionPdf(
		context.TODO(),
		"lab_test_id",
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/lab_test/lab_test_id/collection_instruction_pdf", nil, 1)
}

func TestLabTestsGetOrdersWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.GetOrdersLabTestsRequest{}
	_, invocationErr := client.LabTests.GetOrders(
		context.TODO(),
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/orders", nil, 1)
}

func TestLabTestsGetPhlebotomyAppointmentAvailabilityWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.GetPhlebotomyAppointmentAvailabilityLabTestsRequest{
		Body: &vitalgo.UsAddress{
			FirstLine: "first_line",
			City:      "city",
			State:     "state",
			ZipCode:   "zip_code",
		},
	}
	_, invocationErr := client.LabTests.GetPhlebotomyAppointmentAvailability(
		context.TODO(),
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "POST", "/v3/order/phlebotomy/appointment/availability", nil, 1)
}

func TestLabTestsBookPhlebotomyAppointmentWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.BookPhlebotomyAppointmentLabTestsRequest{
		Body: &vitalgo.AppointmentBookingRequest{
			BookingKey: "booking_key",
		},
	}
	_, invocationErr := client.LabTests.BookPhlebotomyAppointment(
		context.TODO(),
		"order_id",
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "POST", "/v3/order/order_id/phlebotomy/appointment/book", nil, 1)
}

func TestLabTestsRequestPhlebotomyAppointmentWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.RequestAppointmentRequest{
		Address: &vitalgo.UsAddress{
			FirstLine: "first_line",
			City:      "city",
			State:     "state",
			ZipCode:   "zip_code",
		},
		Provider: vitalgo.AppointmentProviderGetlabs,
	}
	_, invocationErr := client.LabTests.RequestPhlebotomyAppointment(
		context.TODO(),
		"order_id",
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "POST", "/v3/order/order_id/phlebotomy/appointment/request", nil, 1)
}

func TestLabTestsReschedulePhlebotomyAppointmentWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.ReschedulePhlebotomyAppointmentLabTestsRequest{
		Body: &vitalgo.AppointmentRescheduleRequest{
			BookingKey: "booking_key",
		},
	}
	_, invocationErr := client.LabTests.ReschedulePhlebotomyAppointment(
		context.TODO(),
		"order_id",
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "PATCH", "/v3/order/order_id/phlebotomy/appointment/reschedule", nil, 1)
}

func TestLabTestsCancelPhlebotomyAppointmentWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.ApiApiV1EndpointsVitalApiLabTestingOrdersHelpersAppointmentCancelRequest{
		CancellationReasonId: "cancellation_reason_id",
	}
	_, invocationErr := client.LabTests.CancelPhlebotomyAppointment(
		context.TODO(),
		"order_id",
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "PATCH", "/v3/order/order_id/phlebotomy/appointment/cancel", nil, 1)
}

func TestLabTestsGetPhlebotomyAppointmentCancellationReasonWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	_, invocationErr := client.LabTests.GetPhlebotomyAppointmentCancellationReason(
		context.TODO(),
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/order/phlebotomy/appointment/cancellation-reasons", nil, 1)
}

func TestLabTestsGetPhlebotomyAppointmentWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	_, invocationErr := client.LabTests.GetPhlebotomyAppointment(
		context.TODO(),
		"order_id",
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/order/order_id/phlebotomy/appointment", nil, 1)
}

func TestLabTestsGetAreaInfoWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.GetAreaInfoLabTestsRequest{
		ZipCode: "zip_code",
	}
	_, invocationErr := client.LabTests.GetAreaInfo(
		context.TODO(),
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/order/area/info", map[string]string{"zip_code": "zip_code"}, 1)
}

func TestLabTestsGetPscInfoWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.GetPscInfoLabTestsRequest{
		ZipCode: "zip_code",
		LabId:   1,
	}
	_, invocationErr := client.LabTests.GetPscInfo(
		context.TODO(),
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/order/psc/info", map[string]string{"zip_code": "zip_code", "lab_id": "1"}, 1)
}

func TestLabTestsGetOrderPscInfoWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.GetOrderPscInfoLabTestsRequest{}
	_, invocationErr := client.LabTests.GetOrderPscInfo(
		context.TODO(),
		"order_id",
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/order/order_id/psc/info", nil, 1)
}

func TestLabTestsGetResultPdfWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	_, invocationErr := client.LabTests.GetResultPdf(
		context.TODO(),
		"order_id",
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/order/order_id/result/pdf", nil, 1)
}

func TestLabTestsGetResultMetadataWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	_, invocationErr := client.LabTests.GetResultMetadata(
		context.TODO(),
		"order_id",
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/order/order_id/result/metadata", nil, 1)
}

func TestLabTestsGetResultRawWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	_, invocationErr := client.LabTests.GetResultRaw(
		context.TODO(),
		"order_id",
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/order/order_id/result", nil, 1)
}

func TestLabTestsGetLabelsPdfWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.GetLabelsPdfLabTestsRequest{
		CollectionDate: vitalgo.MustParseDateTime(
			"2024-01-15T09:30:00Z",
		),
	}
	_, invocationErr := client.LabTests.GetLabelsPdf(
		context.TODO(),
		"order_id",
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/order/order_id/labels/pdf", map[string]string{"collection_date": "2024-01-15T09:30:00Z"}, 1)
}

func TestLabTestsGetPscAppointmentAvailabilityWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.GetPscAppointmentAvailabilityLabTestsRequest{
		Lab: vitalgo.AppointmentPscLabs(
			"quest",
		),
	}
	_, invocationErr := client.LabTests.GetPscAppointmentAvailability(
		context.TODO(),
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "POST", "/v3/order/psc/appointment/availability", map[string]string{"lab": "quest"}, 1)
}

func TestLabTestsBookPscAppointmentWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.BookPscAppointmentLabTestsRequest{
		Body: &vitalgo.AppointmentBookingRequest{
			BookingKey: "booking_key",
		},
	}
	_, invocationErr := client.LabTests.BookPscAppointment(
		context.TODO(),
		"order_id",
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "POST", "/v3/order/order_id/psc/appointment/book", nil, 1)
}

func TestLabTestsReschedulePscAppointmentWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.ReschedulePscAppointmentLabTestsRequest{
		Body: &vitalgo.AppointmentRescheduleRequest{
			BookingKey: "booking_key",
		},
	}
	_, invocationErr := client.LabTests.ReschedulePscAppointment(
		context.TODO(),
		"order_id",
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "PATCH", "/v3/order/order_id/psc/appointment/reschedule", nil, 1)
}

func TestLabTestsCancelPscAppointmentWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.VitalCoreClientsLabTestGetlabsSchemaAppointmentCancelRequest{
		CancellationReasonId: "cancellationReasonId",
	}
	_, invocationErr := client.LabTests.CancelPscAppointment(
		context.TODO(),
		"order_id",
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "PATCH", "/v3/order/order_id/psc/appointment/cancel", nil, 1)
}

func TestLabTestsGetPscAppointmentCancellationReasonWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	_, invocationErr := client.LabTests.GetPscAppointmentCancellationReason(
		context.TODO(),
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/order/psc/appointment/cancellation-reasons", nil, 1)
}

func TestLabTestsGetPscAppointmentWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	_, invocationErr := client.LabTests.GetPscAppointment(
		context.TODO(),
		"order_id",
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/order/order_id/psc/appointment", nil, 1)
}

func TestLabTestsGetOrderCollectionInstructionPdfWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	_, invocationErr := client.LabTests.GetOrderCollectionInstructionPdf(
		context.TODO(),
		"order_id",
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/order/order_id/collection_instruction_pdf", nil, 1)
}

func TestLabTestsGetOrderRequistionPdfWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	_, invocationErr := client.LabTests.GetOrderRequistionPdf(
		context.TODO(),
		"order_id",
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/order/order_id/requisition/pdf", nil, 1)
}

func TestLabTestsGetOrderAbnPdfWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	_, invocationErr := client.LabTests.GetOrderAbnPdf(
		context.TODO(),
		"order_id",
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/order/order_id/abn_pdf", nil, 1)
}

func TestLabTestsGetOrderWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	_, invocationErr := client.LabTests.GetOrder(
		context.TODO(),
		"order_id",
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "GET", "/v3/order/order_id", nil, 1)
}

func TestLabTestsCreateOrderWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.CreateOrderRequestCompatible{
		UserId: "user_id",
		PatientDetails: &vitalgo.PatientDetailsWithValidation{
			FirstName: "first_name",
			LastName:  "last_name",
			Dob: vitalgo.MustParseDateTime(
				"2023-01-15",
			),
			Gender:      vitalgo.GenderFemale,
			PhoneNumber: "phone_number",
			Email:       "email",
		},
		PatientAddress: &vitalgo.PatientAddressWithValidation{
			FirstLine: "first_line",
			City:      "city",
			State:     "state",
			Zip:       "zip",
			Country:   "country",
		},
	}
	_, invocationErr := client.LabTests.CreateOrder(
		context.TODO(),
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "POST", "/v3/order", nil, 1)
}

func TestLabTestsImportOrderWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.ImportOrderBody{
		UserId:           "user_id",
		BillingType:      vitalgo.BillingClientBill,
		OrderSet:         &vitalgo.OrderSetRequest{},
		CollectionMethod: vitalgo.LabTestCollectionMethodTestkit,
		PatientDetails: &vitalgo.PatientDetailsWithValidation{
			FirstName: "first_name",
			LastName:  "last_name",
			Dob: vitalgo.MustParseDateTime(
				"2023-01-15",
			),
			Gender:      vitalgo.GenderFemale,
			PhoneNumber: "phone_number",
			Email:       "email",
		},
		PatientAddress: &vitalgo.PatientAddress{
			ReceiverName: "receiver_name",
			FirstLine:    "first_line",
			City:         "city",
			State:        "state",
			Zip:          "zip",
			Country:      "country",
		},
		SampleId: "sample_id",
	}
	_, invocationErr := client.LabTests.ImportOrder(
		context.TODO(),
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "POST", "/v3/order/import", nil, 1)
}

func TestLabTestsCancelOrderWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	_, invocationErr := client.LabTests.CancelOrder(
		context.TODO(),
		"order_id",
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "POST", "/v3/order/order_id/cancel", nil, 1)
}

func TestLabTestsSimulateOrderProcessWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.SimulateOrderProcessLabTestsRequest{
		Body: &vitalgo.SimulationFlags{},
	}
	_, invocationErr := client.LabTests.SimulateOrderProcess(
		context.TODO(),
		"order_id",
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "POST", "/v3/order/order_id/test", nil, 1)
}

func TestLabTestsUpdateOnSiteCollectionOrderDrawCompletedWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	_, invocationErr := client.LabTests.UpdateOnSiteCollectionOrderDrawCompleted(
		context.TODO(),
		"order_id",
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "PATCH", "/v3/order/order_id/draw_completed", nil, 1)
}

func TestLabTestsValidateIcdCodesWithWireMock(
	t *testing.T,
) {
	ResetWireMockRequests(t)
	WireMockBaseURL := "http://localhost:8080"
	client := client.NewClient(
		option.WithBaseURL(
			WireMockBaseURL,
		),
	)
	request := &vitalgo.ValidateIcdCodesBody{
		Codes: []string{
			"codes",
		},
	}
	_, invocationErr := client.LabTests.ValidateIcdCodes(
		context.TODO(),
		request,
	)

	require.NoError(t, invocationErr, "Client method call should succeed")
	VerifyRequestCount(t, "POST", "/v3/insurance/validate_icd_codes", nil, 1)
}
